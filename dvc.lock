schema: '2.0'
stages:
  data_ingestion:
    cmd: python src/data/data_ingestion.py
    deps:
    - path: data/raw/Reddit_Data.csv
      hash: md5
      md5: 38ee083169162dbac0cb07c80ac0f04e
      size: 6888934
    - path: src/data/data_ingestion.py
      hash: md5
      md5: 321d9409c9e5f0f8e07bce194fcc1c2f
      size: 3192
    params:
      params.yaml:
        data_ingestion:
          source_path: data/raw/Reddit_Data.csv
          processed_dir: data/processed
          test_size: 0.2
          random_state: 42
          target_mapping:
            -1: 2
            0: 0
            1: 1
          num_classes: 3
    outs:
    - path: data/processed/test.csv
      hash: md5
      md5: 5bb74c7cf163d5e0f3af2e550f6355b4
      size: 1385083
    - path: data/processed/train.csv
      hash: md5
      md5: ab45326e6ced6b9f4c1d9b4d4699206d
      size: 5532445
  data_preprocessing:
    cmd: python src/data/data_preprocessing.py
    deps:
    - path: data/processed/test.csv
      hash: md5
      md5: 5bb74c7cf163d5e0f3af2e550f6355b4
      size: 1385083
    - path: data/processed/train.csv
      hash: md5
      md5: ab45326e6ced6b9f4c1d9b4d4699206d
      size: 5532445
    - path: src/data/data_preprocessing.py
      hash: md5
      md5: 2149a3a7a916d4b285014df717e02de3
      size: 4955
    params:
      params.yaml:
        preprocessing:
          input_train_file: train.csv
          input_test_file: test.csv
          output_train_file: train_clean.csv
          output_test_file: test_clean.csv
          remove_html: true
          remove_urls: true
          lower_case: true
    outs:
    - path: data/processed/test_clean.csv
      hash: md5
      md5: f6d8e95611345104cabf0e6a8d61af3f
      size: 1039534
    - path: data/processed/train_clean.csv
      hash: md5
      md5: 710cc8e8f808f93e004b1a46960615fe
      size: 4146117
  build_features:
    cmd: python src/features/build_features.py --config params.yaml
    deps:
    - path: data/processed/test_clean.csv
      hash: md5
      md5: f6d8e95611345104cabf0e6a8d61af3f
      size: 1039534
    - path: data/processed/train_clean.csv
      hash: md5
      md5: 710cc8e8f808f93e004b1a46960615fe
      size: 4146117
    - path: src/features/build_features.py
      hash: md5
      md5: 4210cd4fa3e24eeaf27ba8277ae9011d
      size: 3487
    params:
      params.yaml:
        build_features.max_features: 10000
        build_features.ngram_range:
        - 1
        - 3
    outs:
    - path: data/processed/test_features.pkl
      hash: md5
      md5: 3842e075f99d8bfe759f0d074160dbd4
      size: 1496647
    - path: data/processed/tfidf_vectorizer.pkl
      hash: md5
      md5: 102e2c986827b8041f9716b29c89052d
      size: 383904
    - path: data/processed/train_features.pkl
      hash: md5
      md5: 450c122443f7c0f03fbb35b812f7d87d
      size: 6091058
  train_model:
    cmd: python src/models/train_model.py --config params.yaml
    deps:
    - path: data/processed/train_features.pkl
      hash: md5
      md5: 450c122443f7c0f03fbb35b812f7d87d
      size: 6091058
    - path: src/models/train_model.py
      hash: md5
      md5: 0673225a6d3d74c5cf0cdecd7ec1e8a6
      size: 3812
    params:
      params.yaml:
        model_params.base_model_lgbm:
          learning_rate: 0.08
          max_depth: 20
          n_estimators: 367
          class_weight: balanced
          objective: multiclass
          metric: multi_logloss
          num_class: 3
        model_params.base_model_logreg:
          max_iter: 1000
          solver: lbfgs
          class_weight: balanced
        model_params.meta_model_knn:
          n_neighbors: 5
          metric: minkowski
    outs:
    - path: models/stacking_model.pkl
      hash: md5
      md5: 5a896021ecc7a91709991fcc8642dd0a
      size: 6897020
  evaluate_model:
    cmd: python src/models/evaluate_model.py --config params.yaml
    deps:
    - path: data/processed/test_features.pkl
      hash: md5
      md5: 3842e075f99d8bfe759f0d074160dbd4
      size: 1496647
    - path: models/stacking_model.pkl
      hash: md5
      md5: 5a896021ecc7a91709991fcc8642dd0a
      size: 6897020
    - path: src/models/evaluate_model.py
      hash: md5
      md5: 7f5f99ba3024878452bc93a6efa7d4a7
      size: 2553
    outs:
    - path: metrics.json
      hash: md5
      md5: 428ec9df8a526053b1f9367ca53629b1
      size: 150
